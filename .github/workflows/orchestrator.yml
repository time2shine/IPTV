name: Orchestrate EPG Pipeline

on:
  schedule:
    - cron: "0 */4 * * *"     # every 4 hours (UTC)
  workflow_dispatch: {}       # manual: runs the full chain

# Stop overlapping chains per branch
concurrency:
  group: epg-pipeline-${{ github.ref_name }}
  cancel-in-progress: false

# Pass repo secrets to called workflows when needed
permissions:
  contents: write

jobs:
  update_json_status:
    name: 1) Update JSON Status
    uses: ./.github/workflows/update_json_status.yml
    secrets: inherit

  combine_all_links:
    name: 2) Combine All Links
    needs: [update_json_status]
    uses: ./.github/workflows/combine_all_links.yml
    secrets: inherit

  epg:
    name: 3) EPG
    needs: [combine_all_links]
    uses: ./.github/workflows/epg.yml
    secrets: inherit
